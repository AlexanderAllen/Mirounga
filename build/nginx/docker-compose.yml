version: '3.4'

#
# README.md -
#
# Start nginx service
# docker-compose -f build/nginx/docker-compose.yml up -d
# Creating network "nginx_default" with the default driver
# Creating nginx_nginx_1 ... done
#
# docker-compose -f build/nginx/docker-compose.yml ps
#     Name              Command          State                      Ports
# -------------------------------------------------------------------------------------------
# nginx_nginx_1   nginx -g daemon off;   Up      127.0.0.1:443->443/tcp, 127.0.0.1:80->80/tcp
#
# Test
#
# curl localhost
#
services:
  nginx:
    image: alexanderallen/nginx:1.17-alpine
    build:
      context: .
      dockerfile: Dockerfile
      target: core
    environment:
      PHP_INI_MAX_EXECUTION_TIME: 120 # The defualt is 30, increasing to 60.
      PHP_INI_MEM_LIMIT: 256M # The dfeulat memory limit is 128M.
      PHP_FPM_LISTEN: 127.0.0.1:9010 # The default port is 9000, which conflicts with XDebug. Move to 9010.
    ports:
        - 127.0.0.1:80:80
        - 127.0.0.1:443:443
